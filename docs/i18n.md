# Internationalization (i18n) Strategy

This document outlines the internationalization (i18n) strategy for the PNP Game Engine project.

## Overview

The PNP Game Engine supports multiple languages to make it accessible to developers worldwide. Currently supported languages are:

- **English (en)** - Default language
- **Vietnamese (vi)** - Secondary language

## Architecture

### Builder UI (builders/)

The Builder UI tools (Character Builder, Map Builder) use a client-side i18n system:

#### Directory Structure
```
builders/
├── character-builder/
│   └── i18n/
│       ├── en.json     # English translations
│       ├── vi.json     # Vietnamese translations
│       └── i18n.js     # i18n helper module
└── map-builder/
    └── i18n/
        ├── en.json     # English translations
        ├── vi.json     # Vietnamese translations
        └── i18n.js     # i18n helper module
```

#### Usage in HTML

Use `data-i18n` attributes for static text:

```html
<h1 data-i18n="header.title">Default Text</h1>
<input data-i18n-placeholder="form.namePlaceholder" placeholder="Default placeholder">
```

#### Usage in JavaScript

Use the global `t()` function for dynamic text:

```javascript
// Get translated string
const message = t('messages.success');

// With parameter interpolation
const error = t('errors.notFound', { id: 'item123' });
```

#### Switching Languages

```javascript
// Switch to Vietnamese
I18n.switchLocale('vi');

// Switch to English
I18n.switchLocale('en');

// Get current locale
const currentLocale = I18n.getLocale();
```

### Core Engine (base/src/)

The Core Engine uses a TypeScript-based i18n module for internal messages:

#### Directory Structure
```
base/src/i18n/
├── en.ts       # English translations
├── vi.ts       # Vietnamese translations
├── i18n.ts     # Main i18n module
└── index.ts    # Module exports
```

#### Usage

```typescript
import { t, setLocale, getLocale } from '@nhatphucpham/game-core-client';

// Set locale
setLocale('vi');

// Get translated message
const errorMsg = t('errors.gameNotInitialized');

// With parameters
const canvasError = t('errors.canvasNotFound', { canvasId: 'myCanvas' });
```

#### Available Functions

| Function | Description |
|----------|-------------|
| `t(key, params?)` | Get translated string by key |
| `setLocale(locale)` | Set current locale |
| `getLocale()` | Get current locale |
| `getAvailableLocales()` | Get list of available locales |
| `hasKey(key)` | Check if translation key exists |
| `initI18n(config)` | Initialize with configuration |

## Translation Key Structure

### Builder UI Keys

```json
{
  "header": {
    "title": "...",
    "description": "..."
  },
  "nav": {
    "characterBuilder": "...",
    "mapBuilder": "..."
  },
  "form": {
    "label": "...",
    "placeholder": "..."
  },
  "buttons": {
    "generate": "...",
    "download": "..."
  },
  "messages": {
    "success": "...",
    "error": "..."
  }
}
```

### Core Engine Keys

```typescript
{
  errors: {
    gameNotInitialized: '...',
    canvasNotFound: '...',
    // ...
  },
  warnings: {
    assetAlreadyLoaded: '...',
    // ...
  },
  info: {
    gameInitialized: '...',
    // ...
  },
  debug: {
    frameRate: '...',
    // ...
  }
}
```

## Adding New Translations

### For Builder UI

1. Add the key to both `en.json` and `vi.json` files
2. Use the key in HTML with `data-i18n` or in JS with `t()`

### For Core Engine

1. Add the key to both `en.ts` and `vi.ts` files
2. Import and use `t()` function in your code

## Parameter Interpolation

Both systems support parameter interpolation using `{paramName}` syntax:

```json
{
  "errors": {
    "notFound": "Item not found with id: {itemId}"
  }
}
```

```javascript
t('errors.notFound', { itemId: '12345' });
// Output: "Item not found with id: 12345"
```

## Fallback Behavior

If a translation key is not found in the current locale, the system will:

1. Try to find the key in the fallback locale (English)
2. If still not found, return the key itself and log a warning

## Demo Documentation

Demo documentation is available in multiple languages:

- `demo/README.md` - English (default)
- `demo/README.vi.md` - Vietnamese

## Best Practices

1. **Use descriptive key paths**: e.g., `form.characterName.label`
2. **Keep translations in sync**: Update all locale files when adding keys
3. **Use parameter interpolation**: For dynamic content instead of string concatenation
4. **Provide fallback text**: In HTML elements for graceful degradation
5. **Test both languages**: Verify translations work correctly

## Contributing Translations

To add a new language:

1. Create new translation files (e.g., `fr.json`, `fr.ts`)
2. Add the locale to `getAvailableLocales()` function
3. Update the translations map
4. Add language switcher button/option in UI
5. Submit a pull request

## Future Enhancements

- [ ] Add more languages (Spanish, Chinese, etc.)
- [ ] Right-to-left (RTL) language support
- [ ] Pluralization rules
- [ ] Date/time/number formatting per locale
- [ ] Translation management integration
